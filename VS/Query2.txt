-- Query 2: Reservation Readiness Query 
-- This query returns reservations that are “ready” for pickup (i.e. the reservation has a pickup date set, and all reserved items have an available date prior to or equal to that pickup date):

SET LINESIZE 120;
SET PAGESIZE 200;

SELECT 
  r.ReservationID,
  r.MemberID,
  r.ReservationDate,
  r.PickupDate,
  rd.BookID,
  b.Title,
  rd.AvailableDate,
  r.ReservationStatus
FROM Reservation r
JOIN ReservationDetail rd ON r.ReservationID = rd.ReservationID
JOIN Book b ON rd.BookID = b.BookID
WHERE r.PickupDate IS NOT NULL
  AND r.ReservationStatus = 'READY'
  AND rd.AvailableDate <= r.PickupDate;
